
---

## ☁️ 雲端整合說明

本系統透過 Google Apps Script 建立 Web App，將刷卡資料以 HTTP GET 或 POST 請求方式傳送至 Google 試算表。Apps Script 接收到資料後，自動寫入指定試算表的行列中，實現即時雲端同步，無需額外的第三方服務或付費平台。

---

## 📦 安裝與部署

1. **硬體接線**
   - RFID 模組與 ESP32 使用 SPI 介面   rfid:MFRC-522 RC522 RFID IC卡
   - OLED 使用 I2C（SCL/SDA）螢幕iCshop 0.96吋 OLED顯示螢幕 128x64 藍色 IIC SSD1306
   - iCShop SD卡模組與 RFID 共用 SPI，但需指定不同 CS 腳位

2. **Arduino IDE 設定**
   - 板子選擇：`ESP32 NODEMCU-32S`
   - 上傳速率：115200
   - 安裝所需函式庫

3. **設定 Google Apps Script**
   - 建立新試算表
   - 進入 Apps Script 編輯器，貼上 Web App 程式碼
   - 部署為 Web App 並取得 URL
   - 將該 URL 填入 Arduino 程式中

4. **網頁伺服器**
   - 程式內建簡易網頁
   - 預設顯示最近刷卡記錄

---

## 📄 資料儲存格式

- **SD 卡: 儲存程式碼，讓esp32能夠直接接電使用
- **Google Sheet**：欄位為 UID、時間、姓名、帳號、密碼等
- **網頁介面**：
✅ 顯示最近 10 筆刷卡資料
網頁首頁會動態顯示最新 10 筆刷卡紀錄，包含：

卡號（UID）

刷卡時間（年月日時分秒）

資料來源或裝置識別（如有）

預設顯示 10 筆，可依需求在設定中調整顯示數量，適合快速掌握即時狀況。

✅ 訪客登記表單
提供一個簡易的線上表單介面，供現場管理人員或訪客手動登記：

訪客姓名

訪客事由（訪問對象、會議名稱等）

時間會自動記錄

選配輸入欄位如：聯絡電話、車號等（可擴充）

登記資料可與刷卡資料對應分析，用於補充無卡人員進出紀錄。

✅ 刷卡紀錄查詢系統
支援以以下條件查詢歷史刷卡資料：

輸入完整或部分 卡號（UID） 進行篩選

選擇特定 日期範圍 查詢資料（支援單日/多日）

結果會以表格方式列出，並可選擇匯出為 CSV（目前是要手動下載並轉成csv若已實作）

此功能便於快速查找個人紀錄或統整某一時段的使用狀況。

✅ 異常警報與視覺提示
網頁介面具備簡易的異常警示系統，會在下列情況主動標示提醒：

重複刷卡：同一張卡短時間內重複感應

未授權卡片：系統未註冊或封鎖的 UID

連續錯誤：短時間內連續感應失敗或格式錯誤

警報會以紅色高亮、提示文字、或聲音/閃爍提示（如前端支援）方式顯示，幫助管理者即時注意可疑行為。


---

## 🧪 適用場景

- 學校學生點名與考勤記錄  
- 小型公司門禁感應與刷卡報表  
- 活動簽到、會員打卡  
- 原型產品開發與物聯網研究  

---

## 📌 未來擴充方向

- ✅ 支援多語言顯示與本地化
- ✅ 串接 LINE Notify 或 Telegram Bot 推播
- ✅ 設置攝像頭加入視覺辨識
---


