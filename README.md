這是一份非常詳細且實用的專案說明，涵蓋了功能、部署與未來展望。為了讓它在專業度和可讀性上更上一層樓，我會針對每個區塊進行優化，特別是增加一些技術細節和更清晰的說明。

---

## ☁️ 雲端整合說明

本系統基於 Google Apps Script 平台，建立高效率的 Web App。透過標準的 HTTP GET/POST 請求，可無縫接收來自硬體設備的刷卡資料，並即時寫入指定的 Google 試算表。此架構實現了資料的**即時雲端同步**，不僅省去額外的第三方服務或付費平台，更提供了高彈性和易於管理的資料儲存方案。

---

## 📦 安裝與部署指南

為確保系統順利運行，請依照以下步驟進行硬體接線、軟體設定與部署：

### 1. 硬體接線

本系統的核心硬體採用 ESP32 微控制器，並整合以下周邊模組：

* **RFID 讀取模組：** 採用 **MFRC-522 RC522 RFID IC 卡模組**，透過 **SPI 介面**與 ESP32 連接。請確保 SDA (MOSI), SCK, MISO, RST, 和 IRQ 等腳位正確對應。
* **OLED 顯示器：** 採用 **iCshop 0.96 吋 OLED 顯示螢幕 (128x64 藍色，SSD1306 驅動)**，透過 **I2C 介面** (SCL/SDA) 與 ESP32 連接。
* **SD 卡模組：** 採用 **iCShop SD 卡模組**。此模組與 RFID 模組共用 SPI 匯流排，但**必須指定不同的 Chip Select (CS) 腳位**以避免衝突，確保資料傳輸的獨立性。

### 2. Arduino IDE 環境設定

請按照以下步驟配置 Arduino IDE：

* **板子選擇：** 在 Arduino IDE 的「工具」>「板子」選單中，選擇 `ESP32 NODEMCU-32S`。
* **上傳速率：** 設定為 `115200 bps` 以確保穩定的程式上傳。
* **函式庫安裝：** 透過「工具」>「管理函式庫」或手動方式安裝以下必要函式庫：
    * `MFRC522` (用於 RFID 讀取)
    * `SSD1306` 或相容的 OLED 顯示函式庫 (例如 `Adafruit SSD1306`, `U8g2` 等)
    * `SD` (用於 SD 卡讀寫)
    * `WiFi` (用於 ESP32 網路連線)
    * `HTTPClient` (用於 HTTP 請求)

### 3. Google Apps Script 設定與部署

* **建立新的 Google 試算表：** 作為資料儲存的後端。
* **進入 Apps Script 編輯器：** 在試算表介面中，點擊「擴充功能」>「Apps Script」開啟專案。
* **貼上 Web App 程式碼：** 將預先準備好的 Apps Script 程式碼貼入編輯器中。此程式碼將負責接收 HTTP 請求並將資料寫入試算表。
* **部署為 Web App：**
    1.  點擊「部署」>「新增部署」。
    2.  選擇部署類型為「網路應用程式」。
    3.  「執行身分」建議選擇「我本人」。
    4.  「可存取者」設定為「任何人」。
    5.  完成部署後，**請務必複製 Apps Script 提供的 Web App URL**。
* **更新 Arduino 程式：** 將複製的 Web App URL 填入您的 Arduino 程式碼中，作為資料傳送的目標位址。

### 4. 內建網頁伺服器

ESP32 程式內建一個輕量級的網頁伺服器，預設用於：

* **顯示最近刷卡記錄：** 提供一個簡易的介面，方便使用者即時查看最新的刷卡狀態，無需額外的監控工具。

---

## 📄 資料儲存與使用者介面設計

本系統在資料儲存與使用者介面方面提供多樣化的功能，確保資料的完整性、可查詢性及易用性。

### 資料儲存格式

* **SD 卡：** 主要用於儲存 ESP32 的**韌體程式碼**，使其能夠直接接電後啟動運行，提供獨立運作的能力。此外，SD 卡也可作為**離線緩存**，在網路不穩定時暫存刷卡數據，待網路恢復後再同步至 Google Sheet，提高系統穩定性。
* **Google Sheet：** 作為主要雲端資料庫，採用清晰的欄位結構儲存所有刷卡記錄，例如：`UID` (卡片唯一識別碼)、`時間` (刷卡時間戳記)、`姓名`、`帳號`、`密碼` 等，方便後續的資料分析與管理。

### 網頁介面功能

✅ **即時刷卡記錄顯示**
網頁首頁將**動態顯示最新的 10 筆刷卡紀錄**，使用者可快速掌握即時進出狀況。每筆記錄將清晰呈現：
* **卡號 (UID)**
* **刷卡時間 (年月日時分秒)**
* **資料來源或裝置識別 (如有多個讀卡器)**
預設顯示數量可依據需求在設定中彈性調整。

✅ **訪客登記表單**
提供一個簡潔直觀的線上表單介面，專為現場管理人員或訪客手動登記設計。表單包含：
* **訪客姓名**
* **訪客事由** (如：訪問對象、會議名稱、送貨等)
* **時間** (自動記錄，無需手動輸入)
* **選配輸入欄位** (可擴充，例如：聯絡電話、車號、來訪單位等)
此功能可補充無卡人員的進出紀錄，並與刷卡資料進行對應分析，提供更全面的門禁管理視圖。

✅ **刷卡紀錄查詢系統**
強大的歷史刷卡資料查詢功能，支援以下條件進行精確篩選：
* **卡號 (UID)：** 可輸入完整或部分卡號進行模糊查詢。
* **日期範圍：** 支援單日或多日查詢，提供彈性的時間篩選。
查詢結果將以**表格方式清晰列出**，並可選擇**匯出為 CSV 格式** (若已實作，建議提供前端匯出按鈕，簡化操作流程)，便於快速查找個人紀錄或統整某一時段的使用狀況。

✅ **異常警報與視覺提示**
網頁介面內建簡易的異常警示系統，透過**視覺高亮、提示文字**，甚至可擴充**聲音/閃爍提示** (如前端支援)，幫助管理者即時注意可疑行為：
* **重複刷卡：** 在短時間內檢測到同一張卡片重複感應。
* **未授權卡片：** 系統中未註冊或已封鎖的 UID 進行感應。
* **連續錯誤：** 短時間內連續發生感應失敗或資料格式錯誤。
這些警示有效提升系統的安全性與管理效率。

---

## 🧪 適用場景

本系統因其高度靈活性與實用性，廣泛適用於多種應用場景：

* **學校學生點名與考勤記錄：** 自動化點名流程，並產生詳細的考勤報表。
* **小型公司門禁感應與刷卡報表：** 提供基礎的門禁控制，並生成員工進出記錄，簡化行政作業。
* **活動簽到、會員打卡：** 快速記錄參與者或會員的簽到/打卡時間，提升活動效率。
* **原型產品開發與物聯網 (IoT) 研究：** 作為低成本、高效率的物聯網數據採集與雲端同步解決方案，適用於各類原型驗證與研究專案。

---

## 📌 未來擴充方向

本專案具備高度可擴充性，未來可進一步整合更多先進功能，以提升使用者體驗和系統實用性：

* ✅ **支援多語言顯示與本地化：** 根據使用者設定或瀏覽器語言自動切換介面語言，提升國際化使用者體驗。
* ✅ **串接 LINE Notify 或 Telegram Bot 推播：** 實現即時事件通知，例如：異常刷卡警報、特定人員進出通知等，提升管理效率。
* ✅ **設置攝像頭加入視覺辨識：** 結合影像辨識技術，實現人臉辨識或物件識別，進一步強化門禁安全性或數據採集能力，例如：刷卡時進行人臉比對，防止代打卡行為。

---
